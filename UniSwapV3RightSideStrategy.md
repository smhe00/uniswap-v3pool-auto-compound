
ðŸ›¡ï¸ Uniswap V3 è‡ªåŠ¨åŒ–å³ä¾§æŠ•èµ„ç­–ç•¥ (UniSwapV3 Right Side Strategy)
========================================================

> **æž¶æž„å£°æ˜Ž**ï¼šæœ¬ç³»ç»ŸåŸºäºŽ **TLA+ å½¢å¼åŒ–éªŒè¯** æž„å»ºã€‚
> ç­–ç•¥ç»†èŠ‚å‚è§ TLA+æè¿°æ–‡ä»¶: UniSwapV3RightSideStrategy.tla

**ç­–ç•¥æ¦‚è¿°**ï¼šæœ¬ç³»ç»Ÿæ˜¯ä¸€å¥—é’ˆå¯¹ Uniswap V3 è®¾è®¡çš„è‡ªåŠ¨åŒ–æµåŠ¨æ€§ç®¡ç†æ–¹æ¡ˆï¼Œæ ¸å¿ƒé€»è¾‘åœ¨äºŽé€šè¿‡åŠ¨æ€é£Žé™©è¯„ä¼°ä¸Žâ€œç»å¯¹å³ä¾§â€å»ºä»“ç®—æ³•ï¼Œåœ¨æ•æ‰ ETH éœ‡è¡æ”¶ç›Šçš„åŒæ—¶ï¼Œå®žçŽ°æžç«¯è¡Œæƒ…ä¸‹çš„èµ„äº§ä¿å…¨ã€‚

ä¸€ã€ ç­–ç•¥æ ¸å¿ƒé€»è¾‘æè¿° (Quant Strategy Overview)
-------------------------------------

æœ¬ç­–ç•¥é€šè¿‡é«˜åº¦æ¨¡å—åŒ–çš„é€»è¾‘ï¼Œå®žçŽ°å¯¹é“¾ä¸Šå¤´å¯¸çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œå…¶æ ¸å¿ƒè¿è¡Œæœºåˆ¶å¦‚ä¸‹ï¼š

### 1\. åŠ¨æ€é£Žé™©è°ƒèŠ‚æœºåˆ¶ (Risk-Adjusted Management)

*   **âœ… å¤åˆæ”¶ç›Šæ¨¡å¼ (Compounding Mode)**
    *   **æ ¸å¿ƒè¡Œä¸º**ï¼šå½“å¸‚åœºä»·æ ¼å¤„äºŽé¢„è®¾çš„æµåŠ¨æ€§åŒºé—´ï¼ˆTick Rangeï¼‰å†…æ—¶ï¼Œç³»ç»Ÿæ‰§è¡Œè‡ªåŠ¨åŒ–å¤æŠ•é€»è¾‘ï¼Œå°†æ‰‹ç»­è´¹æ”¶ç›Šå®žæ—¶æ³¨å…¥å¤´å¯¸ï¼Œæœ€å¤§åŒ–èµ„é‡‘åˆ©ç”¨çŽ‡ã€‚
*   **ðŸŸ¡ éœ‡è¡å®¹å¿ä¸Žè‡ªæ„ˆ (Volatility Buffer)**
    *   **æ ¸å¿ƒè¡Œä¸º**ï¼šå½“ä»·æ ¼å‘ç”Ÿçž¬æ—¶åç¦»ï¼ˆå‡ºç•Œï¼‰æ—¶ï¼Œç³»ç»Ÿå¹¶ä¸ç«‹å³è§¦å‘å¼ºåˆ¶å¹³ä»“ã€‚
    *   **æŠ€æœ¯å®žçŽ°**ï¼šå¼•å…¥â€œæ—¶é—´çª—å£å»¶è¿Ÿâ€æœºåˆ¶ï¼Œè¿‡æ»¤é«˜é¢‘éšæœºå™ªå£°ã€‚è‹¥ä»·æ ¼åœ¨é¢„è®¾çª—å£å†…å›žå½’ï¼Œç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«ä¸ºâ€œå‡çªç ´â€å¹¶æ¢å¤è¿è¡Œï¼Œæœ‰æ•ˆé™ä½Žäº†å› é¢‘ç¹è°ƒä»“å¯¼è‡´çš„æ»‘ç‚¹æŸè€—ã€‚
*   **ðŸ›¡ï¸ åº”æ€¥æ’¤ç¦»ä¸Žé˜²å¾¡ (Emergency Liquidation)**
    *   **è¡Œä¸ºé€»è¾‘**ï¼šå½“å¤–éƒ¨é£Žé™©æŒ‡æ ‡ï¼ˆé›·è¾¾é¢„è­¦ï¼‰è§¦å‘æ—¶ï¼Œç³»ç»Ÿä¼˜å…ˆç¡®ä¿èµ„äº§å®‰å…¨ã€‚
    *   **é“¾ä¸Šç¡®è®¤é”**ï¼šé‡‡ç”¨â€œåŒé‡çŠ¶æ€ç¡®è®¤â€æœºåˆ¶ã€‚ç³»ç»Ÿåœ¨å‘é€æ’¤ç¦»æŒ‡ä»¤åŽï¼Œå¿…é¡»èŽ·å¾—é“¾ä¸Šç»“ç®—æˆåŠŸçš„ç¡®å®šæ€§å›žæ‰§ï¼Œæ‰ä¼šç¡®è®¤ä¸ºé˜²å¾¡å§¿æ€ï¼ˆ100% çŽ°è´§ï¼‰ï¼Œæœç»äº†ç½‘ç»œæ‹¥å µæœŸé—´çš„é€»è¾‘å†²çªã€‚
*   **â„ï¸ è¶‹åŠ¿è§‚å¯ŸæœŸ (Cool-off Period)**
    *   **è¡Œä¸ºé€»è¾‘**ï¼šé£Žé™©è­¦æŠ¥è§£é™¤åŽï¼Œç³»ç»Ÿå¼ºåˆ¶è¿›å…¥è§‚å¯ŸæœŸï¼Œé˜²æ­¢å› è¡Œæƒ…åå¤æ³¢åŠ¨ï¼ˆæ‰«æŸï¼‰é€ æˆçš„è¿žç»­è°ƒä»“ã€‚

### 2\. ç»å¯¹å³ä¾§é‡å¹³è¡¡ç®—æ³• (Absolute Right-Side Zap)

è¿™æ˜¯æœ¬ç­–ç•¥çš„æ ¸å¿ƒç›ˆåˆ©ä¸Žæ•ˆçŽ‡å¼•æ“Žï¼š

*   **é‡‘èžé€»è¾‘**ï¼šç³»ç»ŸåšæŒâ€œå³ä¾§å»ºä»“â€å“²å­¦ã€‚æ— è®ºè¡Œæƒ…å¦‚ä½•æ¼”å˜ï¼Œæ–°å»ºç«‹çš„æµåŠ¨æ€§åŒºé—´ä¸‹é™æ°¸è¿œé«˜äºŽå½“å‰å¸‚åœºä»·æ ¼ ( $LowerTick>CurrentPrice$ )ã€‚
*   **èµ„é‡‘æµä¼˜åŒ– (Zap Module)**ï¼šç”±äºŽå³ä¾§åŒºé—´åœ¨å»ºç«‹åˆæœŸä»…éœ€å•è¾¹èµ„äº§ï¼ˆWETHï¼‰ï¼Œæ™ºèƒ½åˆçº¦ä¼šè‡ªåŠ¨å°†å¤´å¯¸ä¸­æ‰€æœ‰çš„ç¨³å®šå¸ï¼ˆUSDCï¼‰å…¨é¢å…‘æ¢ä¸º WETHã€‚
*   **ä¼˜åŠ¿æ€»ç»“**ï¼š
    *   **é›¶ç°å°˜æ®‹ç•™**ï¼šå½»åº•æ¶ˆé™¤äº†ä¼ ç»ŸåŒå¸é…æ¯”è®¡ç®—ä¸­çš„ç²¾åº¦è¯¯å·®å’Œå†—ä½™èµ„é‡‘æ®‹ç•™ã€‚
    *   **å¤‡å…‘æ”¶ç›Š**ï¼šé€šè¿‡æ»¡ä»“ WETH æŒ‚å•ï¼Œç³»ç»Ÿæœ¬è´¨ä¸Šæ˜¯åœ¨èŽ·å– ETH æ½œåœ¨æ¶¨å¹…çš„åŒæ—¶ï¼Œé¢å¤–èµšå–é«˜é¢çš„æœŸæƒæƒåˆ©é‡‘ï¼ˆæ‰‹ç»­è´¹ï¼‰ã€‚

### 3\. æ•…éšœç†”æ–­æœºåˆ¶ (Fail-safe Halt)

*   **äººå·¥ä»‹å…¥æ¨¡å¼**ï¼šå½“é¢„è¨€æœºæˆ–åº•å±‚ API æ•°æ®æºå‡ºçŽ°å¼‚å¸¸ï¼ˆæ–­è”ã€å»¶è¿Ÿæˆ–é€»è¾‘é”™è¯¯ï¼‰æ—¶ï¼Œç³»ç»Ÿå°†ç«‹å³è§¦å‘â€œåŽŸå­çº§åœæœºâ€ã€‚
*   **æ ¸å¿ƒä¿æŠ¤**ï¼šæ­¤æ—¶æ‰€æœ‰è‡ªåŠ¨åŒ–åˆ’è½¬åŠŸèƒ½å°†é”å®šï¼Œå¼ºåˆ¶è¦æ±‚ç®¡ç†å‘˜é€šè¿‡å¤šç­¾é’±åŒ…è¿›è¡Œäººå·¥ä»‹å…¥æŽ’æŸ¥ï¼Œç¡®ä¿åœ¨â€œæžç«¯ç›²åŒºâ€ä¸‹èµ„äº§ä¸è¢«è¯¯æ“ä½œã€‚


äºŒã€ çŠ¶æ€æœºæµè½¬å›¾
------------------------

```mermaid
stateDiagram-v2
    [*] --> S_COMPOUNDING

    state "âœ… S_COMPOUNDING (æ­£å¸¸å°é’ž)" as S_COMPOUNDING
    state "ðŸŸ¡ S_OOR_WAITING (å‡ºç•Œå€’è®¡æ—¶)" as S_OOR_WAITING
    state "ðŸ›¡ï¸ S_DEFENSIVE_HOLD (ç´§æ€¥æ’¤å‡ºæŒå¸)" as S_DEFENSIVE_HOLD
    state "â„ï¸ S_COOLING_DOWN (æŒ‡æ ‡é™æ¸©æœŸ)" as S_COOLING_DOWN
    state "âš ï¸ S_API_UNKNOWN (ä¼ æ„Ÿå™¨å¤±æ•ˆé”æ­»)" as S_API_UNKNOWN

    %% ä¼ æ„Ÿå™¨å¤±æ•ˆ (ç»å¯¹å¸æ”¶æ€)
    S_COMPOUNDING --> S_API_UNKNOWN: API Timeout
    S_OOR_WAITING --> S_API_UNKNOWN: API Timeout
    S_COOLING_DOWN --> S_API_UNKNOWN: API Timeout
    S_DEFENSIVE_HOLD --> S_API_UNKNOWN: API Timeout

    %% æ­£å¸¸è¾¹ç•Œæ£€æµ‹ä¸Žè‡ªæ„ˆ
    S_COMPOUNDING --> S_OOR_WAITING: Price OOR (Start Timer)
    S_OOR_WAITING --> S_COMPOUNDING: Price In-Range (Reset Timer)

    %% ä¸¤æ­¥èµ°æ’¤ç¦»æµç¨‹
    S_COMPOUNDING --> S_DEFENSIVE_HOLD: Radar DANGER (Tx PENDING to SUCCESS)
    S_OOR_WAITING --> S_DEFENSIVE_HOLD: Radar DANGER (Tx PENDING to SUCCESS)

    %% è­¦æŠ¥è§£é™¤æµç¨‹
    S_DEFENSIVE_HOLD --> S_COOLING_DOWN: Radar NORMAL (Start Cooldown)
    S_COOLING_DOWN --> S_DEFENSIVE_HOLD: Radar DANGER (Reset Cooldown)
    
    %% åŽŸå­é‡ç»„ä¸Žèµ„é‡‘å†å¹³è¡¡ (ç»å¯¹å³ä¾§å»ºä»“)
    S_OOR_WAITING --> S_COMPOUNDING: Timer >= T_DELAY (Zap to WETH and Right-Side Mint)
    S_COOLING_DOWN --> S_COMPOUNDING: Timer >= T_COOLDOWN (Zap to WETH and Right-Side Mint)
```
